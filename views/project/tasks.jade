extends home
block append head
  script(type='text/javascript', src='/static/js/ajaxform.js')
  script(type='text/javascript', src='/static/js/ajaxform-bootstrap.js')

block groupNav
  - var urlBase = '/project/' + page.project.id + '-' + page.project.name;
  li: a(href=urlBase) About
  li: a(href=urlBase + '/members') Group Members
  li.active: a(href=urlBase + '/tasks') Tasks
  li: a(href=urlBase + '/events') Events

/*
extends ../mainLayout
block head
  script(type='text/javascript', src='/static/js/ajaxform.js')
  script(type='text/javascript', src='/static/js/ajaxform-bootstrap.js')
*/

block content
  .container
    .col-md-3
      h3 #{page.project.name}
      hr
      ul.nav.nav-pills.nav-stacked
        li: a(href='/project/' + page.project.id + '-' + page.project.name) About
        li: a(href='/project/' + page.project.id + '-' + page.project.name + '/members') Group Members
        li.active: a(href='/project/' + page.project.id + '-' + page.project.name + '/tasks') Tasks
        li: a(href='/project/' + page.project.id + '-' + page.project.name + '/events') Events
    .col-md-9
      block userContent

        // if session && session.user && session.user.username === page.user.username
        h1 Your Tasks
        hr
        a.btn.btn-default(href='/project/' + page.project.id + '-' + page.project.name + '/tasks/add') Create a task
        br
      if tasks
          .panel.panel-default
            table.table
              tr
                th Name
                th Description
                th Created
                th Due
                th &nbsp;
              each task in tasks
                tr
                  td: a(href='/project/' + page.project.id + '-' + page.project.name + '/tasks/' + task.id + '-' + task.name) #{task.name}
                  td #{task.description}
                  td #{task.joined}
                  td #{task.due}
                  td &nbsp;
          if addtasks
            if addtasks.length > 0
              form#addtask.form-inline
                .form-group
                  label.hidden-xs(for='task') Add Task to Project &nbsp;
                  select.form-control(name='project')
                    each group in addprojects
                      option(value=project.id) #{project.name}
                button.btn.btn-default(type='submit') Add
              script(type='text/javascript').
                $('document').ready(function(){
                  forms.addproject.onSuccess(function(res) {
                    if (res.status === 0) {
                      window.location.reload();
                    }
                  });
                });
            else
              p #{page.group.name} is already a member of all of your projects.

        else
          p #{page.group.name} is not a member of any projects yet.
